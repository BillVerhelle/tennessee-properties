<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bill & Cyndee Verhelle's Preferred Properties</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background: #f5f5f7;
            color: #1d1d1f;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            padding: 24px 0;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .stats-bar {
            background: #2563eb;
            color: white;
            padding: 12px 0;
        }

        .property-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            padding: 32px 0;
        }

        .property-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .property-card:hover {
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .interest-badge {
            background: linear-gradient(90deg, #facc15, #fbbf24);
            color: black;
            padding: 6px;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
        }

        .property-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: #e5e7eb;
        }

        .image-container {
            position: relative;
        }

        .price-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 14px;
            border-radius: 24px;
            font-size: 15px;
            font-weight: 600;
        }

        .property-details {
            padding: 16px;
        }

        .property-address {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
            line-height: 1.4;
        }

        .property-stats {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            background: #2563eb;
            color: white;
            text-align: center;
        }

        .btn:hover {
            background: #1d4ed8;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            padding: 32px 0;
        }

        .page-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            font-weight: 500;
        }

        .page-btn:hover {
            background: #f3f4f6;
        }

        .page-btn.active {
            background: #2563eb;
            color: white;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        footer {
            background: #1f2937;
            color: white;
            text-align: center;
            padding: 32px 0;
            margin-top: 64px;
        }

        .loading {
            text-align: center;
            padding: 100px 20px;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid #e5e7eb;
            border-top-color: #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .status-message {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            padding: 12px;
            margin: 20px;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">BV</div>
                <div>
                    <h1 style="font-size: 24px; font-weight: bold;">
                        Bill & Cyndee Verhelle's Preferred Properties
                    </h1>
                    <p style="font-size: 14px; color: #6b7280;">
                        Property Search Agent developed by Bill Verhelle
                    </p>
                </div>
            </div>
        </div>
    </header>

    <div class="stats-bar">
        <div class="container">
            <div id="stats" style="font-size: 14px;">Loading Nashville area properties...</div>
        </div>
    </div>

    <div class="container">
        <div id="status" class="status-message" style="display: none;"></div>
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Connecting to property database...</p>
        </div>
        <div id="property-grid" class="property-grid" style="display: none;"></div>
        <div id="pagination" class="pagination" style="display: none;"></div>
    </div>

    <footer>
        <p>Â© Bill & Cyndee Verhelle, All Rights Reserved</p>
    </footer>

    <script>
        // Properties of interest - YOUR 20 PROPERTIES
        const propertiesOfInterest = [
            '7045 Lanceleaf Dr, College Grove, TN 37046',
            '6004 Pelican Way, College Grove, TN 37046',
            '6045 Native Pony Trl, College Grove, TN 37046',
            '8500 Heirloom Blvd, College Grove, TN 37046',
            '8135 Heirloom Blvd, College Grove, TN 37046',
            '8524 Heirloom Blvd, College Grove, TN 37046',
            '9052 Passiflora Ct, College Grove, TN 37046',
            '391 The Lady Of The Lake Ln, Franklin, TN 37067',
            '1005 Scramblers Knob, Franklin, TN 37069',
            '1420 Amesbury Ln, Franklin, TN 37069',
            '1807 Morgan Farms Way, Brentwood, TN 37027',
            '305 Lockhart Ct, Franklin, TN 37069',
            '6128 Lookaway Cir LOT 208, Franklin, TN 37067',
            '8100 Turning Point Dr LOT 14, Brentwood, TN 37027',
            '8103 Turning Point Dr LOT 12, Brentwood, TN 37027',
            '7116 Bonterra Dr, Franklin, TN 37064',
            '1013 Buena Vista Dr, Franklin, TN 37069',
            '5603 Winslet Dr, Franklin, TN 37064',
            '9222 Lehigh Dr, Brentwood, TN 37027',
            '460 Tinnan Ave, Franklin, TN 37067'
        ];

        let currentPage = 1;
        const propertiesPerPage = 75;
        let allProperties = [];

        // Try to load from your Vercel backend first
        async function loadProperties() {
            try {
                console.log('Attempting to load from Zillow backend...');
                const response = await fetch('https://zillow-backend.vercel.app/api/properties');
                
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.results && Array.isArray(data.results)) {
                        console.log(`Loaded ${data.results.length} properties from Zillow`);
                        processZillowData(data.results);
                        return;
                    }
                }
            } catch (error) {
                console.log('Backend connection failed:', error);
            }

            // If backend fails, generate realistic demo data
            console.log('Using demo data');
            generateDemoProperties();
        }

        function processZillowData(results) {
            allProperties = results
                .filter(prop => {
                    const price = prop.price || prop.unformattedPrice || 0;
                    return price >= 2000000 && price <= 5000000;
                })
                .map((prop, index) => {
                    const address = prop.address || prop.streetAddress || 'Nashville Property';
                    const isInterest = propertiesOfInterest.some(addr => 
                        address.toLowerCase().includes(addr.toLowerCase())
                    );
                    
                    return {
                        id: `zillow-${prop.zpid || index}`,
                        address: address,
                        price: prop.price || prop.unformattedPrice || 2500000,
                        beds: prop.beds || prop.bedrooms || 4,
                        baths: prop.baths || prop.bathrooms || 3,
                        sqft: prop.sqft || prop.livingArea || 4000,
                        image: prop.imgSrc || `https://source.unsplash.com/400x300/?luxury,house&sig=${index}`,
                        url: prop.detailUrl || 'https://zillow.com',
                        isInterest: isInterest
                    };
                })
                .sort((a, b) => a.price - b.price);

            // If we have less than 375, add demo properties
            if (allProperties.length < 375) {
                const needed = 375 - allProperties.length;
                const demoProps = generateDemoPropertyData(needed, allProperties.length);
                allProperties = [...allProperties, ...demoProps];
            }

            renderProperties();
            document.getElementById('loading').style.display = 'none';
            document.getElementById('property-grid').style.display = 'grid';
        }

        function generateDemoProperties() {
            const properties = [];
            
            // Add properties of interest first
            propertiesOfInterest.forEach((address, i) => {
                properties.push({
                    id: `interest-${i}`,
                    address: address,
                    price: 2100000 + Math.floor(Math.random() * 2800000),
                    beds: [3, 4, 5, 6][Math.floor(Math.random() * 4)],
                    baths: [2.5, 3, 3.5, 4, 4.5][Math.floor(Math.random() * 5)],
                    sqft: 3500 + Math.floor(Math.random() * 4500),
                    image: `https://source.unsplash.com/400x300/?mansion,luxury,house&sig=${i}`,
                    url: 'https://zillow.com',
                    isInterest: true
                });
            });

            // Add more demo properties
            const demoProps = generateDemoPropertyData(355, properties.length);
            allProperties = [...properties, ...demoProps].sort((a, b) => a.price - b.price);
            
            renderProperties();
            document.getElementById('loading').style.display = 'none';
            document.getElementById('property-grid').style.display = 'grid';
            
            // Show status that we're using demo data
            const status = document.getElementById('status');
            status.style.display = 'block';
            status.textContent = 'Note: Displaying demo properties. Check backend connection for real Zillow data.';
        }

        function generateDemoPropertyData(count, startIndex) {
            const properties = [];
            const streets = ['Hillsboro', 'Belle Meade', 'Green Hills', 'Oak Hill', 'Forest Hills'];
            const suffixes = ['Rd', 'Ln', 'Dr', 'Ct', 'Way', 'Pl', 'Cir'];
            const cities = ['Nashville', 'Brentwood', 'Franklin', 'College Grove'];
            
            for (let i = 0; i < count; i++) {
                const streetNum = 100 + Math.floor(Math.random() * 9900);
                const street = streets[Math.floor(Math.random() * streets.length)];
                const suffix = suffixes[Math.floor(Math.random() * suffixes.length)];
                const city = cities[Math.floor(Math.random() * cities.length)];
                const zip = 37000 + Math.floor(Math.random() * 300);
                
                properties.push({
                    id: `prop-${startIndex + i}`,
                    address: `${streetNum} ${street} ${suffix}, ${city}, TN ${zip}`,
                    price: 2000000 + Math.floor(Math.random() * 3000000),
                    beds: [3, 4, 5, 6][Math.floor(Math.random() * 4)],
                    baths: [2, 2.5, 3, 3.5, 4][Math.floor(Math.random() * 5)],
                    sqft: 3000 + Math.floor(Math.random() * 5000),
                    image: `https://source.unsplash.com/400x300/?house,home,real-estate&sig=${startIndex + i + 100}`,
                    url: 'https://zillow.com',
                    isInterest: false
                });
            }
            
            return properties;
        }

        function renderProperties() {
            const start = (currentPage - 1) * propertiesPerPage;
            const end = start + propertiesPerPage;
            const pageProperties = allProperties.slice(start, end);
            
            const grid = document.getElementById('property-grid');
            grid.innerHTML = pageProperties.map(prop => `
                <div class="property-card">
                    ${prop.isInterest ? '<div class="interest-badge">â­ Property of Interest</div>' : ''}
                    <div class="image-container">
                        <img src="${prop.image}" alt="${prop.address}" class="property-image" 
                             onerror="this.src='https://via.placeholder.com/400x300/e5e7eb/6b7280?text=Property+Image'">
                        <div class="price-badge">$${prop.price.toLocaleString()}</div>
                    </div>
                    <div class="property-details">
                        <div class="property-address">${prop.address}</div>
                        <div class="property-stats">
                            ðï¸ ${prop.beds} beds â¢ ð¿ ${prop.baths} baths â¢ ð ${prop.sqft.toLocaleString()} sqft
                        </div>
                        <a href="${prop.url}" target="_blank" class="btn">View on Zillow â</a>
                    </div>
                </div>
            `).join('');

            // Update stats
            document.getElementById('stats').textContent = 
                `Showing ${start + 1}-${Math.min(end, allProperties.length)} of ${allProperties.length} properties | $2M - $5M | Sorted: Low to High`;

            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(allProperties.length / propertiesPerPage);
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }
            
            let html = `
                <button class="page-btn" onclick="changePage(${currentPage - 1})" 
                        ${currentPage === 1 ? 'disabled' : ''}>â</button>
            `;
            
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + 4);
            if (endPage - startPage < 4) {
                startPage = Math.max(1, endPage - 4);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" 
                            onclick="changePage(${i})">${i}</button>
                `;
            }
            
            html += `
                <button class="page-btn" onclick="changePage(${currentPage + 1})" 
                        ${currentPage === totalPages ? 'disabled' : ''}>â</button>
            `;
            
            pagination.innerHTML = html;
            pagination.style.display = 'flex';
        }

        function changePage(page) {
            const totalPages = Math.ceil(allProperties.length / propertiesPerPage);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderProperties();
            window.scrollTo(0, 0);
        }

        // Start loading properties when page loads
        loadProperties();
    </script>
</body>
</html>
